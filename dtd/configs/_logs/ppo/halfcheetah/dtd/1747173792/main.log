[2025-05-13 22:03:19,515][jax._src.xla_bridge][INFO] - Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
[2025-05-13 22:03:57,109][absl][INFO] - [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID.
[2025-05-13 22:03:57,110][absl][INFO] - [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers=None, handler_registry=None
[2025-05-13 22:03:57,110][absl][INFO] - Initialized registry DefaultCheckpointHandlerRegistry({('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f69f47473a0>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f69f47473a0>}).
[2025-05-13 22:03:57,111][absl][INFO] - orbax-checkpoint version: 0.11.12
[2025-05-13 22:03:57,111][absl][INFO] - [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x7f69f474c3a0> timeout: 600 secs and primary_host=0 for async checkpoint writes
[2025-05-13 22:03:57,112][absl][INFO] - Cleaning up existing temporary directories at /home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792.
[2025-05-13 22:03:57,113][absl][INFO] - Found 0 checkpoint steps in /home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792
[2025-05-13 22:03:57,113][absl][INFO] - [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=None, keep_time_interval=None, keep_period=None, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=1, step_name_format=None, create=True, cleanup_tmp_directories=True, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=None, multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None), root_directory=/home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x7f6a541ddab0>
[2025-05-13 22:10:26,527][absl][INFO] - [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
[2025-05-13 22:10:26,527][absl][INFO] - [process=0] Saving checkpoint at step 1
[2025-05-13 22:10:26,528][absl][INFO] - [process=0] Started async saving checkpoint to /home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792/1.
[2025-05-13 22:10:26,529][root][INFO] - Using ThreadSafeKeyValueSignalingClient
[2025-05-13 22:10:26,531][absl][INFO] - No entry found in handler registry for item: default and args with type: <class 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardSaveArgs'>. Falling back to global handler registry.
[2025-05-13 22:10:26,531][absl][INFO] - Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x7f6b9a137d30>
[2025-05-13 22:10:26,531][absl][INFO] - Deferred registration for item: "default". Adding handler `<orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardCheckpointHandler object at 0x7f69f47741c0>` for item "default" and save args `<class 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardRestoreArgs'>` to `_handler_registry`.
[2025-05-13 22:10:26,536][absl][INFO] - Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False
[2025-05-13 22:10:26,540][absl][INFO] - Creating tmp directory /home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792/1.orbax-checkpoint-tmp-0
[2025-05-13 22:10:26,544][absl][INFO] - Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1747174226541806476, 'commit_timestamp_nsecs': None, 'custom_metadata': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1747174226541806476, "commit_timestamp_nsecs": null, "custom_metadata": {}} to /home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792/1.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA
[2025-05-13 22:10:26,547][absl][INFO] - Creating tmp directory /home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792/1.orbax-checkpoint-tmp-0/default.orbax-checkpoint-tmp-1
[2025-05-13 22:10:26,571][absl][INFO] - [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 41.7 MiB/s (total bytes: 1.6 MiB) (time elapsed: 39 milliseconds) (per-host)
[2025-05-13 22:10:26,588][absl][INFO] - [process=0][thread=async_save] Background save thread started.
[2025-05-13 22:10:26,588][absl][INFO] - [process=0][thread=array_type_handler] Wrote 45 array_metadata.ArrayMetadata to /home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792/1.orbax-checkpoint-tmp-0/default.orbax-checkpoint-tmp-1/array_metadatas/process_0
[2025-05-13 22:10:26,588][absl][INFO] - Finished blocking save in 0.06 seconds. Continuing to save asynchronously to /home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792/1.
[2025-05-13 22:10:26,593][absl][INFO] - [process=0][thread=MainThread][step=1] Starting CheckpointManager Save Finalize thread=save_finalize
[2025-05-13 22:10:26,595][absl][INFO] - [process=0][thread=save_finalize] Waiting for background save thread=async_save.
[2025-05-13 22:10:26,596][absl][INFO] - {'step': 1, 'event_type': 'save', 'directory': '/home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1747174226.5271485, 'wait_for_prev_duration_secs': 0.0004928112030029297, 'checkpointer_blocking_start_time': 1747174226.5279684, 'checkpointer_blocking_duration_secs': 0.06546282768249512, 'get_old_steps_start_time': 1747174226.5934777, 'get_old_steps_duration_secs': 7.62939453125e-06, 'checkpoint_manager_blocking_start_time': 1747174226.5268264, 'checkpoint_manager_blocking_duration_secs': 0.06943368911743164}
[2025-05-13 22:10:26,698][absl][INFO] - [process=0] /jax/checkpoint/write/bytes_per_sec: 9.9 MiB/s (total bytes: 1.6 MiB) (time elapsed: 165 milliseconds) (per-host)
[2025-05-13 22:10:26,698][absl][INFO] - [process=0][thread=async_save] 3 Handler Commit operations completed.
[2025-05-13 22:10:26,699][absl][INFO] - Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1747174226541806476, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} from /home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792/1.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA
[2025-05-13 22:10:26,702][absl][INFO] - Updated Metadata={'item_handlers': {'default': 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1747174226541806476, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} to /home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792/1.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA
[2025-05-13 22:10:26,704][absl][WARNING] - [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
[2025-05-13 22:10:26,710][absl][INFO] - Renaming /home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792/1.orbax-checkpoint-tmp-0/default.orbax-checkpoint-tmp-1 to /home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792/1.orbax-checkpoint-tmp-0/default
[2025-05-13 22:10:26,711][absl][INFO] - Renaming /home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792/1.orbax-checkpoint-tmp-0 to /home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792/1
[2025-05-13 22:10:26,712][absl][INFO] - [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792/1`.
[2025-05-13 22:10:26,712][absl][INFO] - Finished asynchronous save (blocking + background) in 0.18 seconds to /home/4thhia/workdir/dtd/models/ppo/halfcheetah/dtd/noise000/1747173792/1
[2025-05-13 22:10:26,713][absl][INFO] - [process=0][thread=async_save] Background save thread done.
[2025-05-13 22:10:26,713][absl][INFO] - [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
[2025-05-13 22:10:26,713][absl][INFO] - [process=0][thread=save_finalize] No errors found in background save thread=async_save.
[2025-05-13 22:10:26,713][absl][INFO] - [process=0][thread=save_finalize][step=1] CheckpointManager Save Finalize is syncing with other hosts...
[2025-05-13 22:10:26,713][absl][INFO] - [process=0][thread=save_finalize][step=1] CheckpointManager Save Finalize is done on all hosts.
